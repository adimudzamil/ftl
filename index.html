<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malaysia Airlines FTL Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f0f2f5;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        
        .calculator {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 30px;
            width: 100%;
            max-width: 600px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        h1 {
            color: #1a3a8f;
            font-size: 1.8rem;
            margin-bottom: 5px;
        }
        
        .reference-note {
            color: #666;
            font-size: 0.85rem;
            font-style: italic;
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        .time-gmt-container {
            display: flex;
            gap: 10px;
        }
        
        .time-input {
            flex: 2;
        }
        
        .gmt-input {
            flex: 1;
        }
        
        button {
            background-color: #1a3a8f;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            width: 100%;
            margin-top: 10px;
        }
        
        button:hover {
            background-color: #0a2463;
        }
        
        .results {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            background-color: #f8f9fa;
            display: none;
        }
        
        .result-item {
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 5px;
        }
        
        .ok {
            background-color: #d4edda;
            border-left: 4px solid #28a745;
        }
        
        .warning {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
        }
        
        .danger {
            background-color: #f8d7da;
            border-left: 4px solid #dc3545;
        }
        
        .time-display {
            font-size: 1.1rem;
            font-weight: bold;
            margin: 5px 0;
        }
        
        .limits-info {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            background-color: #e9ecef;
            font-size: 0.85rem;
        }
        
        .limits-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        .limits-table th, .limits-table td {
            padding: 5px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .limits-table th {
            background-color: #1a3a8f;
            color: white;
        }
        
        .night-periods {
            margin-top: 10px;
            font-size: 0.8rem;
        }
        
        .night-period {
            margin-bottom: 5px;
            padding: 5px;
            background-color: #f8f9fa;
            border-radius: 3px;
        }
        
        .gmt-info {
            font-size: 0.8rem;
            color: #666;
            margin-top: 5px;
        }
        
        .input-description {
            font-size: 0.75rem;
            color: #666;
            margin-top: 3px;
            font-style: italic;
            line-height: 1.3;
        }
        
        .gmt-comparison {
            margin-top: 10px;
            padding: 8px;
            background-color: #e9ecef;
            border-radius: 5px;
            font-size: 0.85rem;
        }
        
        .non-acclimatized-info {
            margin-top: 10px;
            padding: 8px;
            background-color: #fff3cd;
            border-radius: 5px;
            font-size: 0.85rem;
            border-left: 3px solid #ffc107;
        }
        
        .table-section {
            margin-top: 20px;
        }
        
        .section-title {
            color: #1a3a8f;
            margin-bottom: 10px;
            font-size: 1.1rem;
            border-bottom: 2px solid #1a3a8f;
            padding-bottom: 5px;
        }
        
        .footnote {
            text-align: center;
            margin-top: 25px;
            padding-top: 15px;
            border-top: 1px solid #ddd;
            color: #666;
            font-size: 0.8rem;
        }
        
        .crew-results {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .crew-result {
            flex: 1;
            padding: 10px;
            border-radius: 5px;
            background-color: #f8f9fa;
        }
        
        .crew-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: #1a3a8f;
        }
        
        .special-condition {
            font-size: 0.8rem;
            margin-top: 5px;
            color: #666;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="calculator">
        <div class="header">
            <h1>Malaysia Airlines FTL Calculator</h1>
            <div class="reference-note">Based on OM-A issue 10 revision 1 Ch7.5.8, dated 20/06/25.</div>
        </div>
        
        <div class="input-group">
            <label for="baseGMT">Current GMT</label>
            <select id="baseGMT">
                <!-- GMT options with quarter-hour increments -->
                <option value="-12">GMT-12:00</option>
                <option value="-11.75">GMT-11:45</option>
                <option value="-11.5">GMT-11:30</option>
                <option value="-11.25">GMT-11:15</option>
                <option value="-11">GMT-11:00</option>
                <option value="-10.75">GMT-10:45</option>
                <option value="-10.5">GMT-10:30</option>
                <option value="-10.25">GMT-10:15</option>
                <option value="-10">GMT-10:00</option>
                <option value="-9.75">GMT-09:45</option>
                <option value="-9.5">GMT-09:30</option>
                <option value="-9.25">GMT-09:15</option>
                <option value="-9">GMT-09:00</option>
                <option value="-8.75">GMT-08:45</option>
                <option value="-8.5">GMT-08:30</option>
                <option value="-8.25">GMT-08:15</option>
                <option value="-8">GMT-08:00</option>
                <option value="-7.75">GMT-07:45</option>
                <option value="-7.5">GMT-07:30</option>
                <option value="-7.25">GMT-07:15</option>
                <option value="-7">GMT-07:00</option>
                <option value="-6.75">GMT-06:45</option>
                <option value="-6.5">GMT-06:30</option>
                <option value="-6.25">GMT-06:15</option>
                <option value="-6">GMT-06:00</option>
                <option value="-5.75">GMT-05:45</option>
                <option value="-5.5">GMT-05:30</option>
                <option value="-5.25">GMT-05:15</option>
                <option value="-5">GMT-05:00</option>
                <option value="-4.75">GMT-04:45</option>
                <option value="-4.5">GMT-04:30</option>
                <option value="-4.25">GMT-04:15</option>
                <option value="-4">GMT-04:00</option>
                <option value="-3.75">GMT-03:45</option>
                <option value="-3.5">GMT-03:30</option>
                <option value="-3.25">GMT-03:15</option>
                <option value="-3">GMT-03:00</option>
                <option value="-2.75">GMT-02:45</option>
                <option value="-2.5">GMT-02:30</option>
                <option value="-2.25">GMT-02:15</option>
                <option value="-2">GMT-02:00</option>
                <option value="-1.75">GMT-01:45</option>
                <option value="-1.5">GMT-01:30</option>
                <option value="-1.25">GMT-01:15</option>
                <option value="-1">GMT-01:00</option>
                <option value="-0.75">GMT-00:45</option>
                <option value="-0.5">GMT-00:30</option>
                <option value="-0.25">GMT-00:15</option>
                <option value="0">GMT+00:00</option>
                <option value="0.25">GMT+00:15</option>
                <option value="0.5">GMT+00:30</option>
                <option value="0.75">GMT+00:45</option>
                <option value="1">GMT+01:00</option>
                <option value="1.25">GMT+01:15</option>
                <option value="1.5">GMT+01:30</option>
                <option value="1.75">GMT+01:45</option>
                <option value="2">GMT+02:00</option>
                <option value="2.25">GMT+02:15</option>
                <option value="2.5">GMT+02:30</option>
                <option value="2.75">GMT+02:45</option>
                <option value="3">GMT+03:00</option>
                <option value="3.25">GMT+03:15</option>
                <option value="3.5">GMT+03:30</option>
                <option value="3.75">GMT+03:45</option>
                <option value="4">GMT+04:00</option>
                <option value="4.25">GMT+04:15</option>
                <option value="4.5">GMT+04:30</option>
                <option value="4.75">GMT+04:45</option>
                <option value="5">GMT+05:00</option>
                <option value="5.25">GMT+05:15</option>
                <option value="5.5">GMT+05:30</option>
                <option value="5.75">GMT+05:45</option>
                <option value="6">GMT+06:00</option>
                <option value="6.25">GMT+06:15</option>
                <option value="6.5">GMT+06:30</option>
                <option value="6.75">GMT+06:45</option>
                <option value="7">GMT+07:00</option>
                <option value="7.25">GMT+07:15</option>
                <option value="7.5">GMT+07:30</option>
                <option value="7.75">GMT+07:45</option>
                <option value="8" selected>GMT+08:00</option>
                <option value="8.25">GMT+08:15</option>
                <option value="8.5">GMT+08:30</option>
                <option value="8.75">GMT+08:45</option>
                <option value="9">GMT+09:00</option>
                <option value="9.25">GMT+09:15</option>
                <option value="9.5">GMT+09:30</option>
                <option value="9.75">GMT+09:45</option>
                <option value="10">GMT+10:00</option>
                <option value="10.25">GMT+10:15</option>
                <option value="10.5">GMT+10:30</option>
                <option value="10.75">GMT+10:45</option>
                <option value="11">GMT+11:00</option>
                <option value="11.25">GMT+11:15</option>
                <option value="11.5">GMT+11:30</option>
                <option value="11.75">GMT+11:45</option>
                <option value="12">GMT+12:00</option>
            </select>
            <div class="gmt-info">Select your current GMT, the place where you are departing from today.</div>
        </div>
        
        <div class="input-group">
            <label for="lastDepartureGMT">Last Departure Station GMT</label>
            <select id="lastDepartureGMT">
                <!-- Same GMT options as above -->
                <option value="-12">GMT-12:00</option>
                <option value="-11.75">GMT-11:45</option>
                <option value="-11.5">GMT-11:30</option>
                <option value="-11.25">GMT-11:15</option>
                <option value="-11">GMT-11:00</option>
                <option value="-10.75">GMT-10:45</option>
                <option value="-10.5">GMT-10:30</option>
                <option value="-10.25">GMT-10:15</option>
                <option value="-10">GMT-10:00</option>
                <option value="-9.75">GMT-09:45</option>
                <option value="-9.5">GMT-09:30</option>
                <option value="-9.25">GMT-09:15</option>
                <option value="-9">GMT-09:00</option>
                <option value="-8.75">GMT-08:45</option>
                <option value="-8.5">GMT-08:30</option>
                <option value="-8.25">GMT-08:15</option>
                <option value="-8">GMT-08:00</option>
                <option value="-7.75">GMT-07:45</option>
                <option value="-7.5">GMT-07:30</option>
                <option value="-7.25">GMT-07:15</option>
                <option value="-7">GMT-07:00</option>
                <option value="-6.75">GMT-06:45</option>
                <option value="-6.5">GMT-06:30</option>
                <option value="-6.25">GMT-06:15</option>
                <option value="-6">GMT-06:00</option>
                <option value="-5.75">GMT-05:45</option>
                <option value="-5.5">GMT-05:30</option>
                <option value="-5.25">GMT-05:15</option>
                <option value="-5">GMT-05:00</option>
                <option value="-4.75">GMT-04:45</option>
                <option value="-4.5">GMT-04:30</option>
                <option value="-4.25">GMT-04:15</option>
                <option value="-4">GMT-04:00</option>
                <option value="-3.75">GMT-03:45</option>
                <option value="-3.5">GMT-03:30</option>
                <option value="-3.25">GMT-03:15</option>
                <option value="-3">GMT-03:00</option>
                <option value="-2.75">GMT-02:45</option>
                <option value="-2.5">GMT-02:30</option>
                <option value="-2.25">GMT-02:15</option>
                <option value="-2">GMT-02:00</option>
                <option value="-1.75">GMT-01:45</option>
                <option value="-1.5">GMT-01:30</option>
                <option value="-1.25">GMT-01:15</option>
                <option value="-1">GMT-01:00</option>
                <option value="-0.75">GMT-00:45</option>
                <option value="-0.5">GMT-00:30</option>
                <option value="-0.25">GMT-00:15</option>
                <option value="0">GMT+00:00</option>
                <option value="0.25">GMT+00:15</option>
                <option value="0.5">GMT+00:30</option>
                <option value="0.75">GMT+00:45</option>
                <option value="1">GMT+01:00</option>
                <option value="1.25">GMT+01:15</option>
                <option value="1.5">GMT+01:30</option>
                <option value="1.75">GMT+01:45</option>
                <option value="2">GMT+02:00</option>
                <option value="2.25">GMT+02:15</option>
                <option value="2.5">GMT+02:30</option>
                <option value="2.75">GMT+02:45</option>
                <option value="3">GMT+03:00</option>
                <option value="3.25">GMT+03:15</option>
                <option value="3.5">GMT+03:30</option>
                <option value="3.75">GMT+03:45</option>
                <option value="4">GMT+04:00</option>
                <option value="4.25">GMT+04:15</option>
                <option value="4.5">GMT+04:30</option>
                <option value="4.75">GMT+04:45</option>
                <option value="5">GMT+05:00</option>
                <option value="5.25">GMT+05:15</option>
                <option value="5.5">GMT+05:30</option>
                <option value="5.75">GMT+05:45</option>
                <option value="6">GMT+06:00</option>
                <option value="6.25">GMT+06:15</option>
                <option value="6.5">GMT+06:30</option>
                <option value="6.75">GMT+06:45</option>
                <option value="7">GMT+07:00</option>
                <option value="7.25">GMT+07:15</option>
                <option value="7.5">GMT+07:30</option>
                <option value="7.75">GMT+07:45</option>
                <option value="8" selected>GMT+08:00</option>
                <option value="8.25">GMT+08:15</option>
                <option value="8.5">GMT+08:30</option>
                <option value="8.75">GMT+08:45</option>
                <option value="9">GMT+09:00</option>
                <option value="9.25">GMT+09:15</option>
                <option value="9.5">GMT+09:30</option>
                <option value="9.75">GMT+09:45</option>
                <option value="10">GMT+10:00</option>
                <option value="10.25">GMT+10:15</option>
                <option value="10.5">GMT+10:30</option>
                <option value="10.75">GMT+10:45</option>
                <option value="11">GMT+11:00</option>
                <option value="11.25">GMT+11:15</option>
                <option value="11.5">GMT+11:30</option>
                <option value="11.75">GMT+11:45</option>
                <option value="12">GMT+12:00</option>
            </select>
            <div class="gmt-info">Select last departure station timezone</div>
        </div>
        
        <div class="input-group">
            <label for="lastDutyEnd">Last Duty End Date and Time</label>
            <div class="time-gmt-container">
                <div class="time-input">
                    <input type="datetime-local" id="lastDutyEnd" required>
                </div>
                <div class="gmt-input">
                    <select id="lastDutyEndGMT">
                        <!-- Same GMT options as above -->
                        <option value="-12">GMT-12:00</option>
                        <option value="-11.75">GMT-11:45</option>
                        <option value="-11.5">GMT-11:30</option>
                        <option value="-11.25">GMT-11:15</option>
                        <option value="-11">GMT-11:00</option>
                        <option value="-10.75">GMT-10:45</option>
                        <option value="-10.5">GMT-10:30</option>
                        <option value="-10.25">GMT-10:15</option>
                        <option value="-10">GMT-10:00</option>
                        <option value="-9.75">GMT-09:45</option>
                        <option value="-9.5">GMT-09:30</option>
                        <option value="-9.25">GMT-09:15</option>
                        <option value="-9">GMT-09:00</option>
                        <option value="-8.75">GMT-08:45</option>
                        <option value="-8.5">GMT-08:30</option>
                        <option value="-8.25">GMT-08:15</option>
                        <option value="-8">GMT-08:00</option>
                        <option value="-7.75">GMT-07:45</option>
                        <option value="-7.5">GMT-07:30</option>
                        <option value="-7.25">GMT-07:15</option>
                        <option value="-7">GMT-07:00</option>
                        <option value="-6.75">GMT-06:45</option>
                        <option value="-6.5">GMT-06:30</option>
                        <option value="-6.25">GMT-06:15</option>
                        <option value="-6">GMT-06:00</option>
                        <option value="-5.75">GMT-05:45</option>
                        <option value="-5.5">GMT-05:30</option>
                        <option value="-5.25">GMT-05:15</option>
                        <option value="-5">GMT-05:00</option>
                        <option value="-4.75">GMT-04:45</option>
                        <option value="-4.5">GMT-04:30</option>
                        <option value="-4.25">GMT-04:15</option>
                        <option value="-4">GMT-04:00</option>
                        <option value="-3.75">GMT-03:45</option>
                        <option value="-3.5">GMT-03:30</option>
                        <option value="-3.25">GMT-03:15</option>
                        <option value="-3">GMT-03:00</option>
                        <option value="-2.75">GMT-02:45</option>
                        <option value="-2.5">GMT-02:30</option>
                        <option value="-2.25">GMT-02:15</option>
                        <option value="-2">GMT-02:00</option>
                        <option value="-1.75">GMT-01:45</option>
                        <option value="-1.5">GMT-01:30</option>
                        <option value="-1.25">GMT-01:15</option>
                        <option value="-1">GMT-01:00</option>
                        <option value="-0.75">GMT-00:45</option>
                        <option value="-0.5">GMT-00:30</option>
                        <option value="-0.25">GMT-00:15</option>
                        <option value="0">GMT+00:00</option>
                        <option value="0.25">GMT+00:15</option>
                        <option value="0.5">GMT+00:30</option>
                        <option value="0.75">GMT+00:45</option>
                        <option value="1">GMT+01:00</option>
                        <option value="1.25">GMT+01:15</option>
                        <option value="1.5">GMT+01:30</option>
                        <option value="1.75">GMT+01:45</option>
                        <option value="2">GMT+02:00</option>
                        <option value="2.25">GMT+02:15</option>
                        <option value="2.5">GMT+02:30</option>
                        <option value="2.75">GMT+02:45</option>
                        <option value="3">GMT+03:00</option>
                        <option value="3.25">GMT+03:15</option>
                        <option value="3.5">GMT+03:30</option>
                        <option value="3.75">GMT+03:45</option>
                        <option value="4">GMT+04:00</option>
                        <option value="4.25">GMT+04:15</option>
                        <option value="4.5">GMT+04:30</option>
                        <option value="4.75">GMT+04:45</option>
                        <option value="5">GMT+05:00</option>
                        <option value="5.25">GMT+05:15</option>
                        <option value="5.5">GMT+05:30</option>
                        <option value="5.75">GMT+05:45</option>
                        <option value="6">GMT+06:00</option>
                        <option value="6.25">GMT+06:15</option>
                        <option value="6.5">GMT+06:30</option>
                        <option value="6.75">GMT+06:45</option>
                        <option value="7">GMT+07:00</option>
                        <option value="7.25">GMT+07:15</option>
                        <option value="7.5">GMT+07:30</option>
                        <option value="7.75">GMT+07:45</option>
                        <option value="8" selected>GMT+08:00</option>
                        <option value="8.25">GMT+08:15</option>
                        <option value="8.5">GMT+08:30</option>
                        <option value="8.75">GMT+08:45</option>
                        <option value="9">GMT+09:00</option>
                        <option value="9.25">GMT+09:15</option>
                        <option value="9.5">GMT+09:30</option>
                        <option value="9.75">GMT+09:45</option>
                        <option value="10">GMT+10:00</option>
                        <option value="10.25">GMT+10:15</option>
                        <option value="10.5">GMT+10:30</option>
                        <option value="10.75">GMT+10:45</option>
                        <option value="11">GMT+11:00</option>
                        <option value="11.25">GMT+11:15</option>
                        <option value="11.5">GMT+11:30</option>
                        <option value="11.75">GMT+11:45</option>
                        <option value="12">GMT+12:00</option>
                    </select>
                </div>
            </div>
            <div class="input-description">Check last duty end time in your roster (STA + 30 minutes) or (ATA + 30 minutes)</div>
        </div>
        
        <div class="input-group">
            <label for="dutyStart">Start Time</label>
            <div class="time-gmt-container">
                <div class="time-input">
                    <input type="datetime-local" id="dutyStart" required>
                </div>
                <div class="gmt-input">
                    <select id="startGMT">
                        <!-- Same GMT options as above -->
                        <option value="-12">GMT-12:00</option>
                        <option value="-11.75">GMT-11:45</option>
                        <option value="-11.5">GMT-11:30</option>
                        <option value="-11.25">GMT-11:15</option>
                        <option value="-11">GMT-11:00</option>
                        <option value="-10.75">GMT-10:45</option>
                        <option value="-10.5">GMT-10:30</option>
                        <option value="-10.25">GMT-10:15</option>
                        <option value="-10">GMT-10:00</option>
                        <option value="-9.75">GMT-09:45</option>
                        <option value="-9.5">GMT-09:30</option>
                        <option value="-9.25">GMT-09:15</option>
                        <option value="-9">GMT-09:00</option>
                        <option value="-8.75">GMT-08:45</option>
                        <option value="-8.5">GMT-08:30</option>
                        <option value="-8.25">GMT-08:15</option>
                        <option value="-8">GMT-08:00</option>
                        <option value="-7.75">GMT-07:45</option>
                        <option value="-7.5">GMT-07:30</option>
                        <option value="-7.25">GMT-07:15</option>
                        <option value="-7">GMT-07:00</option>
                        <option value="-6.75">GMT-06:45</option>
                        <option value="-6.5">GMT-06:30</option>
                        <option value="-6.25">GMT-06:15</option>
                        <option value="-6">GMT-06:00</option>
                        <option value="-5.75">GMT-05:45</option>
                        <option value="-5.5">GMT-05:30</option>
                        <option value="-5.25">GMT-05:15</option>
                        <option value="-5">GMT-05:00</option>
                        <option value="-4.75">GMT-04:45</option>
                        <option value="-4.5">GMT-04:30</option>
                        <option value="-4.25">GMT-04:15</option>
                        <option value="-4">GMT-04:00</option>
                        <option value="-3.75">GMT-03:45</option>
                        <option value="-3.5">GMT-03:30</option>
                        <option value="-3.25">GMT-03:15</option>
                        <option value="-3">GMT-03:00</option>
                        <option value="-2.75">GMT-02:45</option>
                        <option value="-2.5">GMT-02:30</option>
                        <option value="-2.25">GMT-02:15</option>
                        <option value="-2">GMT-02:00</option>
                        <option value="-1.75">GMT-01:45</option>
                        <option value="-1.5">GMT-01:30</option>
                        <option value="-1.25">GMT-01:15</option>
                        <option value="-1">GMT-01:00</option>
                        <option value="-0.75">GMT-00:45</option>
                        <option value="-0.5">GMT-00:30</option>
                        <option value="-0.25">GMT-00:15</option>
                        <option value="0">GMT+00:00</option>
                        <option value="0.25">GMT+00:15</option>
                        <option value="0.5">GMT+00:30</option>
                        <option value="0.75">GMT+00:45</option>
                        <option value="1">GMT+01:00</option>
                        <option value="1.25">GMT+01:15</option>
                        <option value="1.5">GMT+01:30</option>
                        <option value="1.75">GMT+01:45</option>
                        <option value="2">GMT+02:00</option>
                        <option value="2.25">GMT+02:15</option>
                        <option value="2.5">GMT+02:30</option>
                        <option value="2.75">GMT+02:45</option>
                        <option value="3">GMT+03:00</option>
                        <option value="3.25">GMT+03:15</option>
                        <option value="3.5">GMT+03:30</option>
                        <option value="3.75">GMT+03:45</option>
                        <option value="4">GMT+04:00</option>
                        <option value="4.25">GMT+04:15</option>
                        <option value="4.5">GMT+04:30</option>
                        <option value="4.75">GMT+04:45</option>
                        <option value="5">GMT+05:00</option>
                        <option value="5.25">GMT+05:15</option>
                        <option value="5.5">GMT+05:30</option>
                        <option value="5.75">GMT+05:45</option>
                        <option value="6">GMT+06:00</option>
                        <option value="6.25">GMT+06:15</option>
                        <option value="6.5">GMT+06:30</option>
                        <option value="6.75">GMT+06:45</option>
                        <option value="7">GMT+07:00</option>
                        <option value="7.25">GMT+07:15</option>
                        <option value="7.5">GMT+07:30</option>
                        <option value="7.75">GMT+07:45</option>
                        <option value="8" selected>GMT+08:00</option>
                        <option value="8.25">GMT+08:15</option>
                        <option value="8.5">GMT+08:30</option>
                        <option value="8.75">GMT+08:45</option>
                        <option value="9">GMT+09:00</option>
                        <option value="9.25">GMT+09:15</option>
                        <option value="9.5">GMT+09:30</option>
                        <option value="9.75">GMT+09:45</option>
                        <option value="10">GMT+10:00</option>
                        <option value="10.25">GMT+10:15</option>
                        <option value="10.5">GMT+10:30</option>
                        <option value="10.75">GMT+10:45</option>
                        <option value="11">GMT+11:00</option>
                        <option value="11.25">GMT+11:15</option>
                        <option value="11.5">GMT+11:30</option>
                        <option value="11.75">GMT+11:45</option>
                        <option value="12">GMT+12:00</option>
                    </select>
                </div>
            </div>
            <div class="input-description">Reporting time at Base/ ex-Station.</div>
        </div>
        
        <div class="input-group">
            <label for="dutyEnd">End Time</label>
            <div class="time-gmt-container">
                <div class="time-input">
                    <input type="datetime-local" id="dutyEnd" required>
                </div>
                <div class="gmt-input">
                    <select id="endGMT">
                        <!-- Same GMT options as above -->
                        <option value="-12">GMT-12:00</option>
                        <option value="-11.75">GMT-11:45</option>
                        <option value="-11.5">GMT-11:30</option>
                        <option value="-11.25">GMT-11:15</option>
                        <option value="-11">GMT-11:00</option>
                        <option value="-10.75">GMT-10:45</option>
                        <option value="-10.5">GMT-10:30</option>
                        <option value="-10.25">GMT-10:15</option>
                        <option value="-10">GMT-10:00</option>
                        <option value="-9.75">GMT-09:45</option>
                        <option value="-9.5">GMT-09:30</option>
                        <option value="-9.25">GMT-09:15</option>
                        <option value="-9">GMT-09:00</option>
                        <option value="-8.75">GMT-08:45</option>
                        <option value="-8.5">GMT-08:30</option>
                        <option value="-8.25">GMT-08:15</option>
                        <option value="-8">GMT-08:00</option>
                        <option value="-7.75">GMT-07:45</option>
                        <option value="-7.5">GMT-07:30</option>
                        <option value="-7.25">GMT-07:15</option>
                        <option value="-7">GMT-07:00</option>
                        <option value="-6.75">GMT-06:45</option>
                        <option value="-6.5">GMT-06:30</option>
                        <option value="-6.25">GMT-06:15</option>
                        <option value="-6">GMT-06:00</option>
                        <option value="-5.75">GMT-05:45</option>
                        <option value="-5.5">GMT-05:30</option>
                        <option value="-5.25">GMT-05:15</option>
                        <option value="-5">GMT-05:00</option>
                        <option value="-4.75">GMT-04:45</option>
                        <option value="-4.5">GMT-04:30</option>
                        <option value="-4.25">GMT-04:15</option>
                        <option value="-4">GMT-04:00</option>
                        <option value="-3.75">GMT-03:45</option>
                        <option value="-3.5">GMT-03:30</option>
                        <option value="-3.25">GMT-03:15</option>
                        <option value="-3">GMT-03:00</option>
                        <option value="-2.75">GMT-02:45</option>
                        <option value="-2.5">GMT-02:30</option>
                        <option value="-2.25">GMT-02:15</option>
                        <option value="-2">GMT-02:00</option>
                        <option value="-1.75">GMT-01:45</option>
                        <option value="-1.5">GMT-01:30</option>
                        <option value="-1.25">GMT-01:15</option>
                        <option value="-1">GMT-01:00</option>
                        <option value="-0.75">GMT-00:45</option>
                        <option value="-0.5">GMT-00:30</option>
                        <option value="-0.25">GMT-00:15</option>
                        <option value="0">GMT+00:00</option>
                        <option value="0.25">GMT+00:15</option>
                        <option value="0.5">GMT+00:30</option>
                        <option value="0.75">GMT+00:45</option>
                        <option value="1">GMT+01:00</option>
                        <option value="1.25">GMT+01:15</option>
                        <option value="1.5">GMT+01:30</option>
                        <option value="1.75">GMT+01:45</option>
                        <option value="2">GMT+02:00</option>
                        <option value="2.25">GMT+02:15</option>
                        <option value="2.5">GMT+02:30</option>
                        <option value="2.75">GMT+02:45</option>
                        <option value="3">GMT+03:00</option>
                        <option value="3.25">GMT+03:15</option>
                        <option value="3.5">GMT+03:30</option>
                        <option value="3.75">GMT+03:45</option>
                        <option value="4">GMT+04:00</option>
                        <option value="4.25">GMT+04:15</option>
                        <option value="4.5">GMT+04:30</option>
                        <option value="4.75">GMT+04:45</option>
                        <option value="5">GMT+05:00</option>
                        <option value="5.25">GMT+05:15</option>
                        <option value="5.5">GMT+05:30</option>
                        <option value="5.75">GMT+05:45</option>
                        <option value="6">GMT+06:00</option>
                        <option value="6.25">GMT+06:15</option>
                        <option value="6.5">GMT+06:30</option>
                        <option value="6.75">GMT+06:45</option>
                        <option value="7">GMT+07:00</option>
                        <option value="7.25">GMT+07:15</option>
                        <option value="7.5">GMT+07:30</option>
                        <option value="7.75">GMT+07:45</option>
                        <option value="8" selected>GMT+08:00</option>
                        <option value="8.25">GMT+08:15</option>
                        <option value="8.5">GMT+08:30</option>
                        <option value="8.75">GMT+08:45</option>
                        <option value="9">GMT+09:00</option>
                        <option value="9.25">GMT+09:15</option>
                        <option value="9.5">GMT+09:30</option>
                        <option value="9.75">GMT+09:45</option>
                        <option value="10">GMT+10:00</option>
                        <option value="10.25">GMT+10:15</option>
                        <option value="10.5">GMT+10:30</option>
                        <option value="10.75">GMT+10:45</option>
                        <option value="11">GMT+11:00</option>
                        <option value="11.25">GMT+11:15</option>
                        <option value="11.5">GMT+11:30</option>
                        <option value="11.75">GMT+11:45</option>
                        <option value="12">GMT+12:00</option>
                    </select>
                </div>
            </div>
            <div class="input-description">Final sector STA/ATA. FDP does not count +30 minutes post flight duty time. If last sector is PS(DHC/Paxiing) insert the previous sector STA/ATA.</div>
        </div>
        
        <div class="input-group">
            <label for="sectors">Number of Sectors</label>
            <input type="number" id="sectors" min="1" max="4" value="1" required>
        </div>
        
        <button id="calculateBtn">Calculate</button>
        
        <div class="results" id="results">
            <div id="resultContent">
                <!-- Results will appear here -->
            </div>
        </div>
        
        <div class="table-section">
            <div class="section-title">Acclimatized Duty Limits</div>
            <div class="limits-info">
                <table class="limits-table">
                    <thead>
                        <tr>
                            <th>Start Time</th>
                            <th>Sectors</th>
                            <th>Cabin Crew Limit</th>
                            <th>Tech Crew Limit</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>0600-0759</td><td>1</td><td>14:00</td><td>13:00</td></tr>
                        <tr><td>0600-0759</td><td>2</td><td>13:15</td><td>12:15</td></tr>
                        <tr><td>0600-0759</td><td>3</td><td>12:30</td><td>11:30</td></tr>
                        <tr><td>0600-0759</td><td>4</td><td>11:45</td><td>10:45</td></tr>
                        <tr><td>0800-1259</td><td>1</td><td>15:00</td><td>14:00</td></tr>
                        <tr><td>0800-1259</td><td>2</td><td>14:15</td><td>13:15</td></tr>
                        <tr><td>0800-1259</td><td>3</td><td>13:30</td><td>12:30</td></tr>
                        <tr><td>0800-1259</td><td>4</td><td>12:45</td><td>11:45</td></tr>
                        <tr><td>1300-1759</td><td>1</td><td>14:00</td><td>13:00</td></tr>
                        <tr><td>1300-1759</td><td>2</td><td>13:15</td><td>12:15</td></tr>
                        <tr><td>1300-1759</td><td>3</td><td>12:30</td><td>11:30</td></tr>
                        <tr><td>1300-1759</td><td>4</td><td>11:45</td><td>10:45</td></tr>
                        <tr><td>1800-2159</td><td>1</td><td>13:00</td><td>12:00</td></tr>
                        <tr><td>1800-2159</td><td>2</td><td>12:15</td><td>11:15</td></tr>
                        <tr><td>1800-2159</td><td>3</td><td>11:30</td><td>10:30</td></tr>
                        <tr><td>1800-2159</td><td>4</td><td>10:45</td><td>09:45</td></tr>
                        <tr><td>2200-0559</td><td>1</td><td>12:00</td><td>11:00</td></tr>
                        <tr><td>2200-0559</td><td>2</td><td>11:15</td><td>10:15</td></tr>
                        <tr><td>2200-0559</td><td>3</td><td>10:30</td><td>09:30</td></tr>
                        <tr><td>2200-0559</td><td>4</td><td>10:00</td><td>09:00</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="table-section">
            <div class="section-title">Non-Acclimatized Duty Limits</div>
            <div class="limits-info">
                <table class="limits-table">
                    <thead>
                        <tr>
                            <th>Rest Period</th>
                            <th>Sectors</th>
                            <th>Cabin Crew Limit</th>
                            <th>Tech Crew Limit</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td rowspan="4">≤18h OR ≥30h</td><td>1</td><td>14:00</td><td>13:00</td></tr>
                        <tr><td>2</td><td>13:15</td><td>12:15</td></tr>
                        <tr><td>3</td><td>12:30</td><td>11:30</td></tr>
                        <tr><td>4</td><td>11:45</td><td>10:45</td></tr>
                        <tr><td rowspan="4">18:01h to 29:59h</td><td>1</td><td>12:30</td><td>11:30</td></tr>
                        <tr><td>2</td><td>12:00</td><td>11:00</td></tr>
                        <tr><td>3</td><td>11:30</td><td>10:30</td></tr>
                        <tr><td>4</td><td>10:45</td><td>09:45</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="footnote">
            by 2100551 16/10/25
        </div>
    </div>

    <script>
        document.getElementById('calculateBtn').addEventListener('click', function() {
            calculate();
        });
        
        function calculate() {
            // Get input values
            const baseGMT = parseFloat(document.getElementById('baseGMT').value);
            const lastDepartureGMT = parseFloat(document.getElementById('lastDepartureGMT').value);
            const startGMT = parseFloat(document.getElementById('startGMT').value);
            const endGMT = parseFloat(document.getElementById('endGMT').value);
            const lastDutyEndGMT = parseFloat(document.getElementById('lastDutyEndGMT').value);
            const lastDutyEnd = new Date(document.getElementById('lastDutyEnd').value);
            const dutyStart = new Date(document.getElementById('dutyStart').value);
            const dutyEnd = new Date(document.getElementById('dutyEnd').value);
            const sectors = parseInt(document.getElementById('sectors').value);
            
            // Calculate duty period in milliseconds (adjusting for timezone differences)
            const dutyMs = calculateDutyPeriodWithTimezone(dutyStart, dutyEnd, startGMT, endGMT);
            
            // Convert to hours and minutes
            const dutyHours = Math.floor(dutyMs / (1000 * 60 * 60));
            const dutyMinutes = Math.floor((dutyMs % (1000 * 60 * 60)) / (1000 * 60));
            
            // Format as HH:MM
            const dutyTimeFormatted = `${dutyHours}h ${dutyMinutes}m`;
            
            // Calculate acclimatization
            const acclimatization = checkAcclimatization(lastDutyEnd, dutyStart, baseGMT, lastDepartureGMT, startGMT, lastDutyEndGMT);
            
            // Determine limits based on start time, sectors, and acclimatization status
            let cabinDutyLimitHours, cabinDutyLimitMinutes;
            
            if (acclimatization.isAcclimatized) {
                // Use normal acclimatized limits
                const startHour = dutyStart.getHours();
                const startMinutes = dutyStart.getMinutes();
                const startTimeInMinutes = startHour * 60 + startMinutes;
                
                // Set duty limits based on all conditions
                cabinDutyLimitHours = 14; // Default fallback
                cabinDutyLimitMinutes = 0;
                
                // 0600-0759
                if (startTimeInMinutes >= 6*60 && startTimeInMinutes < 8*60) {
                    if (sectors === 1) { cabinDutyLimitHours = 14; cabinDutyLimitMinutes = 0; }
                    else if (sectors === 2) { cabinDutyLimitHours = 13; cabinDutyLimitMinutes = 15; }
                    else if (sectors === 3) { cabinDutyLimitHours = 12; cabinDutyLimitMinutes = 30; }
                    else if (sectors === 4) { cabinDutyLimitHours = 11; cabinDutyLimitMinutes = 45; }
                }
                // 0800-1259
                else if (startTimeInMinutes >= 8*60 && startTimeInMinutes < 13*60) {
                    if (sectors === 1) { cabinDutyLimitHours = 15; cabinDutyLimitMinutes = 0; }
                    else if (sectors === 2) { cabinDutyLimitHours = 14; cabinDutyLimitMinutes = 15; }
                    else if (sectors === 3) { cabinDutyLimitHours = 13; cabinDutyLimitMinutes = 30; }
                    else if (sectors === 4) { cabinDutyLimitHours = 12; cabinDutyLimitMinutes = 45; }
                }
                // 1300-1759
                else if (startTimeInMinutes >= 13*60 && startTimeInMinutes < 18*60) {
                    if (sectors === 1) { cabinDutyLimitHours = 14; cabinDutyLimitMinutes = 0; }
                    else if (sectors === 2) { cabinDutyLimitHours = 13; cabinDutyLimitMinutes = 15; }
                    else if (sectors === 3) { cabinDutyLimitHours = 12; cabinDutyLimitMinutes = 30; }
                    else if (sectors === 4) { cabinDutyLimitHours = 11; cabinDutyLimitMinutes = 45; }
                }
                // 1800-2159
                else if (startTimeInMinutes >= 18*60 && startTimeInMinutes < 22*60) {
                    if (sectors === 1) { cabinDutyLimitHours = 13; cabinDutyLimitMinutes = 0; }
                    else if (sectors === 2) { cabinDutyLimitHours = 12; cabinDutyLimitMinutes = 15; }
                    else if (sectors === 3) { cabinDutyLimitHours = 11; cabinDutyLimitMinutes = 30; }
                    else if (sectors === 4) { cabinDutyLimitHours = 10; cabinDutyLimitMinutes = 45; }
                }
                // 2200-0559 (crosses midnight)
                else if (startTimeInMinutes >= 22*60 || startTimeInMinutes < 6*60) {
                    if (sectors === 1) { cabinDutyLimitHours = 12; cabinDutyLimitMinutes = 0; }
                    else if (sectors === 2) { cabinDutyLimitHours = 11; cabinDutyLimitMinutes = 15; }
                    else if (sectors === 3) { cabinDutyLimitHours = 10; cabinDutyLimitMinutes = 30; }
                    else if (sectors === 4) { cabinDutyLimitHours = 10; cabinDutyLimitMinutes = 0; }
                }
            } else {
                // Use non-acclimatized limits based on rest period
                const restHours = acclimatization.restHours;
                
                if (restHours <= 18 || restHours >= 30) {
                    // Table 1: Rest period ≤18 hours OR ≥30 hours
                    if (sectors === 1) { cabinDutyLimitHours = 14; cabinDutyLimitMinutes = 0; }
                    else if (sectors === 2) { cabinDutyLimitHours = 13; cabinDutyLimitMinutes = 15; }
                    else if (sectors === 3) { cabinDutyLimitHours = 12; cabinDutyLimitMinutes = 30; }
                    else if (sectors === 4) { cabinDutyLimitHours = 11; cabinDutyLimitMinutes = 45; }
                } else {
                    // Table 2: Rest period between 18:01 and 29:59 hours
                    if (sectors === 1) { cabinDutyLimitHours = 12; cabinDutyLimitMinutes = 30; }
                    else if (sectors === 2) { cabinDutyLimitHours = 12; cabinDutyLimitMinutes = 0; }
                    else if (sectors === 3) { cabinDutyLimitHours = 11; cabinDutyLimitMinutes = 30; }
                    else if (sectors === 4) { cabinDutyLimitHours = 10; cabinDutyLimitMinutes = 45; }
                }
            }
            
            // Calculate tech crew limits
            let techDutyLimitHours, techDutyLimitMinutes;
            let specialCondition = "";
            
            // Calculate duty period in decimal hours for tech crew conditions
            const dutyDecimal = dutyMs / (1000 * 60 * 60);
            
            // For sectors 2,3,4, use the standard rule (1 hour less than cabin crew)
            if (sectors > 1) {
                techDutyLimitHours = cabinDutyLimitHours - 1;
                techDutyLimitMinutes = cabinDutyLimitMinutes;
                
                // Handle cases where subtracting 1 hour affects the minutes
                if (techDutyLimitHours < 0) {
                    techDutyLimitHours = 0;
                }
            } 
            // For sector 1, apply special tech crew conditions
            else {
                const startHour = dutyStart.getHours();
                const startMinutes = dutyStart.getMinutes();
                const startTimeInMinutes = startHour * 60 + startMinutes;
                
                if (acclimatization.isAcclimatized) {
                    // Determine start time block
                    let timeBlock;
                    if (startTimeInMinutes >= 6*60 && startTimeInMinutes < 8*60) timeBlock = '0600-0759';
                    else if (startTimeInMinutes >= 8*60 && startTimeInMinutes < 13*60) timeBlock = '0800-1259';
                    else if (startTimeInMinutes >= 13*60 && startTimeInMinutes < 18*60) timeBlock = '1300-1759';
                    else if (startTimeInMinutes >= 18*60 && startTimeInMinutes < 22*60) timeBlock = '1800-2159';
                    else timeBlock = '2200-0559';
                    
                    if (dutyDecimal >= 7 && dutyDecimal < 9) {
                        // 7h to 8h59m
                        specialCondition = "Duty period 7h-8h59m, Sector 1";
                        switch(timeBlock) {
                            case '0600-0759': techDutyLimitHours = 12; techDutyLimitMinutes = 15; break;
                            case '0800-1259': techDutyLimitHours = 13; techDutyLimitMinutes = 15; break;
                            case '1300-1759': techDutyLimitHours = 12; techDutyLimitMinutes = 15; break;
                            case '1800-2159': techDutyLimitHours = 11; techDutyLimitMinutes = 15; break;
                            case '2200-0559': techDutyLimitHours = 10; techDutyLimitMinutes = 15; break;
                        }
                    } else if (dutyDecimal >= 9 && dutyDecimal < 11) {
                        // 9h to 10h59m
                        specialCondition = "Duty period 9h-10h59m, Sector 1";
                        switch(timeBlock) {
                            case '0600-0759': techDutyLimitHours = 11; techDutyLimitMinutes = 30; break;
                            case '0800-1259': techDutyLimitHours = 12; techDutyLimitMinutes = 30; break;
                            case '1300-1759': techDutyLimitHours = 11; techDutyLimitMinutes = 30; break;
                            case '1800-2159': techDutyLimitHours = 10; techDutyLimitMinutes = 30; break;
                            case '2200-0559': techDutyLimitHours = 9; techDutyLimitMinutes = 30; break;
                        }
                    } else if (dutyDecimal >= 11) {
                        // 11h and above
                        specialCondition = "Duty period 11h+, Sector 1";
                        switch(timeBlock) {
                            case '0600-0759': techDutyLimitHours = 10; techDutyLimitMinutes = 45; break;
                            case '0800-1259': techDutyLimitHours = 11; techDutyLimitMinutes = 45; break;
                            case '1300-1759': techDutyLimitHours = 10; techDutyLimitMinutes = 45; break;
                            case '1800-2159': techDutyLimitHours = 9; techDutyLimitMinutes = 45; break;
                            case '2200-0559': techDutyLimitHours = 9; techDutyLimitMinutes = 0; break;
                        }
                    } else {
                        // Default for duty periods less than 7 hours
                        techDutyLimitHours = cabinDutyLimitHours - 1;
                        techDutyLimitMinutes = cabinDutyLimitMinutes;
                    }
                } else {
                    // Non-acclimatized tech crew, sector 1
                    const restHours = acclimatization.restHours;
                    
                    if (dutyDecimal >= 7 && dutyDecimal < 9) {
                        // 7h to 8h59m
                        specialCondition = "Duty period 7h-8h59m, Sector 1";
                        if (restHours <= 18 || restHours >= 30) {
                            techDutyLimitHours = 11; techDutyLimitMinutes = 45;
                        } else {
                            techDutyLimitHours = 10; techDutyLimitMinutes = 45;
                        }
                    } else if (dutyDecimal >= 9 && dutyDecimal < 11) {
                        // 9h to 10h59m
                        specialCondition = "Duty period 9h-10h59m, Sector 1";
                        if (restHours <= 18 || restHours >= 30) {
                            techDutyLimitHours = 11; techDutyLimitMinutes = 45;
                        } else {
                            techDutyLimitHours = 10; techDutyLimitMinutes = 45;
                        }
                    } else if (dutyDecimal >= 11) {
                        // 11h and above
                        specialCondition = "Duty period 11h+, Sector 1";
                        techDutyLimitHours = null; // N/A
                        techDutyLimitMinutes = null;
                    } else {
                        // Default for duty periods less than 7 hours
                        techDutyLimitHours = cabinDutyLimitHours - 1;
                        techDutyLimitMinutes = cabinDutyLimitMinutes;
                    }
                }
            }
            
            // Format duty limits for display
            let cabinDutyLimitFormatted = `${cabinDutyLimitHours}h`;
            if (cabinDutyLimitMinutes > 0) {
                cabinDutyLimitFormatted += ` ${cabinDutyLimitMinutes}m`;
            }
            
            let techDutyLimitFormatted = "N/A";
            if (techDutyLimitHours !== null) {
                techDutyLimitFormatted = `${techDutyLimitHours}h`;
                if (techDutyLimitMinutes > 0) {
                    techDutyLimitFormatted += ` ${techDutyLimitMinutes}m`;
                }
            }
            
            // Set sector limits
            const sectorLimit = 4;
            
            // Check compliance for both crew types
            const cabinDutyLimitDecimal = cabinDutyLimitHours + (cabinDutyLimitMinutes / 60);
            const techDutyLimitDecimal = techDutyLimitHours !== null ? 
                techDutyLimitHours + (techDutyLimitMinutes / 60) : null;
            
            const cabinDutyStatus = dutyDecimal <= cabinDutyLimitDecimal ? 'ok' : 'danger';
            const techDutyStatus = techDutyLimitDecimal !== null && dutyDecimal <= techDutyLimitDecimal ? 'ok' : 'danger';
            const sectorStatus = sectors <= sectorLimit ? 'ok' : 'danger';
            
            // Create result messages
            let resultHTML = '';
            
            // Acclimatization result
            resultHTML += `<div class="result-item ${acclimatization.status}">`;
            resultHTML += `<strong>Acclimatization:</strong> ${acclimatization.message}<br>`;
            resultHTML += `<strong>Rest Period:</strong> ${acclimatization.restPeriod}<br>`;
            resultHTML += `<strong>Night Periods with 8+ hours rest:</strong> ${acclimatization.validNightPeriods} of 2 required`;
            
            // Show timezone info if applicable
            if (acclimatization.timezoneExemption) {
                resultHTML += `<div class="gmt-comparison">`;
                resultHTML += `<strong>Timezone Exemption:</strong> Last departure station GMT${lastDepartureGMT >= 0 ? '+' : ''}${lastDepartureGMT} is within ±2 hours of Current GMT${baseGMT >= 0 ? '+' : ''}${baseGMT}`;
                resultHTML += `</div>`;
            }
            
            // Show non-acclimatized info if applicable
            if (!acclimatization.isAcclimatized) {
                resultHTML += `<div class="non-acclimatized-info">`;
                resultHTML += `<strong>Non-Acclimatized Limits Applied:</strong> `;
                if (acclimatization.restHours <= 18 || acclimatization.restHours >= 30) {
                    resultHTML += `Rest period (${acclimatization.restPeriod}) is ≤18h OR ≥30h`;
                } else {
                    resultHTML += `Rest period (${acclimatization.restPeriod}) is between 18:01h and 29:59h`;
                }
                resultHTML += `</div>`;
            }
            
            // Show night period details
            if (acclimatization.nightPeriods.length > 0) {
                resultHTML += `<div class="night-periods">`;
                acclimatization.nightPeriods.forEach((period, index) => {
                    const status = period.restHours >= 8 ? '✓' : '✗';
                    resultHTML += `<div class="night-period">${status} Night ${index+1}: ${period.date} (${period.restHours.toFixed(1)}h rest)</div>`;
                });
                resultHTML += `</div>`;
            }
            
            resultHTML += `</div>`;
            
            // Duty period result - now with both cabin and tech crew
            resultHTML += `<div class="result-item">`;
            resultHTML += `<strong>Duty Period:</strong>`;
            resultHTML += `<div class="time-display">${dutyTimeFormatted}</div>`;
            resultHTML += `<div class="crew-results">`;
            
            // Cabin crew result
            resultHTML += `<div class="crew-result ${cabinDutyStatus}">`;
            resultHTML += `<div class="crew-title">Cabin Crew</div>`;
            resultHTML += `<strong>Limit:</strong> ${cabinDutyLimitFormatted}<br>`;
            resultHTML += cabinDutyStatus === 'ok' ? 
                '✓ Within limit' : 
                '✗ Exceeds limit!';
            resultHTML += `</div>`;
            
            // Tech crew result
            resultHTML += `<div class="crew-result ${techDutyStatus}">`;
            resultHTML += `<div class="crew-title">Tech Crew</div>`;
            resultHTML += `<strong>Limit:</strong> ${techDutyLimitFormatted}<br>`;
            if (specialCondition) {
                resultHTML += `<div class="special-condition">${specialCondition}</div>`;
            }
            if (techDutyLimitFormatted === "N/A") {
                resultHTML += 'N/A - Not applicable';
            } else {
                resultHTML += techDutyStatus === 'ok' ? 
                    '✓ Within limit' : 
                    '✗ Exceeds limit!';
            }
            resultHTML += `</div>`;
            
            resultHTML += `</div>`;
            resultHTML += `</div>`;
            
            // Sectors result
            resultHTML += `<div class="result-item ${sectorStatus}">`;
            resultHTML += `<strong>Sectors:</strong> ${sectors}<br>`;
            resultHTML += `<strong>Limit:</strong> ${sectorLimit}<br>`;
            resultHTML += sectorStatus === 'ok' ? 
                '✓ Within limit' : 
                '✗ Exceeds limit!';
            resultHTML += `</div>`;
            
            // Display results
            document.getElementById('resultContent').innerHTML = resultHTML;
            document.getElementById('results').style.display = 'block';
        }
        
        function calculateDutyPeriodWithTimezone(startTime, endTime, startGMT, endGMT) {
            // Convert both times to UTC for accurate calculation
            const startUTC = new Date(startTime.getTime() + (startGMT * 60 * 60 * 1000));
            const endUTC = new Date(endTime.getTime() + (endGMT * 60 * 60 * 1000));
            
            // Calculate the difference
            return endUTC - startUTC;
        }
        
        function checkAcclimatization(lastDutyEnd, dutyStart, baseGMT, lastDepartureGMT, startGMT, lastDutyEndGMT) {
            // Calculate total rest period in hours (adjusting for timezone)
            const lastDutyEndUTC = new Date(lastDutyEnd.getTime() + (lastDutyEndGMT * 60 * 60 * 1000));
            const dutyStartUTC = new Date(dutyStart.getTime() + (startGMT * 60 * 60 * 1000));
            const restMs = dutyStartUTC - lastDutyEndUTC;
            const restHours = restMs / (1000 * 60 * 60);
            
            // Format rest period for display
            const restHoursFormatted = Math.floor(restHours);
            const restMinutesFormatted = Math.floor((restHours % 1) * 60);
            const restPeriod = `${restHoursFormatted}h ${restMinutesFormatted}m`;
            
            // Check if last departure station GMT is within ±2 hours of current GMT
            const timezoneDifference = Math.abs(lastDepartureGMT - baseGMT);
            const timezoneExemption = timezoneDifference <= 2;
            
            // Count night periods (2200 to 0800) with at least 8 hours of rest
            let validNightPeriods = 0;
            let nightPeriods = [];
            
            // Start from the day of last duty end
            let currentDate = new Date(lastDutyEndUTC);
            currentDate.setHours(0, 0, 0, 0);
            
            // Check up to 5 days to cover all possible night periods
            for (let i = 0; i < 5; i++) {
                const nightStart = new Date(currentDate);
                nightStart.setHours(22, 0, 0, 0);
                
                const nightEnd = new Date(currentDate);
                nightEnd.setDate(nightEnd.getDate() + 1);
                nightEnd.setHours(8, 0, 0, 0);
                
                // If the night period is completely outside the rest period, skip
                if (nightEnd <= lastDutyEndUTC || nightStart >= dutyStartUTC) {
                    currentDate.setDate(currentDate.getDate() + 1);
                    continue;
                }
                
                // Calculate overlap between rest period and night period
                const overlapStart = new Date(Math.max(lastDutyEndUTC.getTime(), nightStart.getTime()));
                const overlapEnd = new Date(Math.min(dutyStartUTC.getTime(), nightEnd.getTime()));
                
                const overlapHours = (overlapEnd - overlapStart) / (1000 * 60 * 60);
                
                // Only count if there's a positive overlap
                if (overlapHours > 0) {
                    const isValid = overlapHours >= 8;
                    if (isValid) validNightPeriods++;
                    
                    nightPeriods.push({
                        date: nightStart.toLocaleDateString(),
                        restHours: overlapHours,
                        isValid: isValid
                    });
                }
                
                currentDate.setDate(currentDate.getDate() + 1);
            }
            
            // Determine acclimatization status
            let status = 'danger';
            let message = 'Not Acclimatized';
            let isAcclimatized = false;
            
            // Check if timezone exemption applies
            if (timezoneExemption) {
                status = 'ok';
                message = 'Acclimatized (Timezone Exemption)';
                isAcclimatized = true;
            }
            // Otherwise apply normal rules
            else if (validNightPeriods >= 2 && restHours >= 34) {
                status = 'ok';
                message = 'Acclimatized';
                isAcclimatized = true;
            } else if (validNightPeriods >= 2 && restHours < 34) {
                status = 'warning';
                message = 'Night periods OK but rest < 34h';
            } else if (validNightPeriods < 2 && restHours >= 34) {
                status = 'warning';
                message = 'Rest period OK but insufficient night periods';
            }
            
            return {
                status: status,
                message: message,
                restPeriod: restPeriod,
                restHours: restHours,
                validNightPeriods: validNightPeriods,
                nightPeriods: nightPeriods,
                timezoneExemption: timezoneExemption,
                isAcclimatized: isAcclimatized
            };
        }
        
        // Set default date/time values
        window.onload = function() {
            const now = new Date();
            
            // Format for datetime-local input
            const formatDateTime = (date) => {
                return date.toISOString().slice(0, 16);
            };
            
            // Set all datetime inputs to current device date and time
            document.getElementById('lastDutyEnd').value = formatDateTime(now);
            document.getElementById('dutyStart').value = formatDateTime(now);
            document.getElementById('dutyEnd').value = formatDateTime(now);
            
            // Set GMT defaults to +8
            document.getElementById('baseGMT').value = "8";
            document.getElementById('lastDepartureGMT').value = "8";
            document.getElementById('lastDutyEndGMT').value = "8";
            document.getElementById('startGMT').value = "8";
            document.getElementById('endGMT').value = "8";
        };
    </script>
</body>
</html>