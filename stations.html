<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malaysia Airlines Stations Database</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚úàÔ∏è</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f0f2f5;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #1a3a8f;
        }
        
        h1 {
            color: #1a3a8f;
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #666;
            font-size: 1rem;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .search-box {
            flex: 1;
            min-width: 300px;
            position: relative;
        }
        
        .search-box input {
            width: 100%;
            padding: 12px 40px 12px 15px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        .search-box .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
        }
        
        .filter-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        select {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            background-color: white;
            font-size: 1rem;
        }
        
        .station-count {
            background-color: #1a3a8f;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
        }
        
        .stations-table-container {
            overflow-x: auto;
            margin-top: 20px;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }
        
        thead {
            background-color: #1a3a8f;
            color: white;
            position: sticky;
            top: 0;
        }
        
        th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #0a2463;
        }
        
        tbody tr {
            border-bottom: 1px solid #eee;
            transition: background-color 0.2s;
        }
        
        tbody tr:hover {
            background-color: #f8f9fa;
        }
        
        td {
            padding: 15px;
            vertical-align: top;
        }
        
        .iata-code {
            font-weight: bold;
            color: #1a3a8f;
            font-size: 1.1rem;
        }
        
        .station-name {
            font-weight: 500;
            color: #333;
        }
        
        .country {
            color: #666;
            font-size: 0.9rem;
        }
        
        .gmt-offset {
            display: inline-block;
            padding: 5px 10px;
            background-color: #e8f5e9;
            color: #2e7d32;
            border-radius: 4px;
            font-weight: 600;
            font-family: 'Courier New', monospace;
        }
        
        .gmt-offset.negative {
            background-color: #ffebee;
            color: #c62828;
        }
        
        .gmt-offset.half {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .dst-indicator {
            font-size: 0.8rem;
            color: #666;
            margin-top: 3px;
        }
        
        .has-dst {
            border-left: 3px solid #ff9800;
            padding-left: 8px;
        }
        
        .base-station {
            background-color: #e3f2fd;
        }
        
        .base-badge {
            background-color: #2196f3;
            color: white;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.8rem;
            margin-left: 5px;
        }
        
        .legend {
            margin-top: 30px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 5px;
            border-left: 4px solid #1a3a8f;
        }
        
        .legend h3 {
            margin-bottom: 10px;
            color: #1a3a8f;
        }
        
        .legend-items {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 10px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }
        
        .legend-color.base {
            background-color: #e3f2fd;
        }
        
        .legend-color.dst {
            background-color: #fff3cd;
        }
        
        .footer {
            margin-top: 30px;
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            color: #666;
            font-size: 0.9rem;
        }
        
        .data-actions {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background-color: #1a3a8f;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #0a2463;
        }
        
        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #545b62;
        }
        
        .btn-success {
            background-color: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #218838;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .search-box {
                min-width: 100%;
            }
            
            th, td {
                padding: 10px;
            }
        }
        
        /* New station form */
        .new-station-form {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            margin-top: 30px;
            border-left: 4px solid #28a745;
        }
        
        .new-station-form h3 {
            color: #1a3a8f;
            margin-bottom: 15px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #333;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }
        
        .form-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 5px;
            color: white;
            font-weight: 500;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            animation: slideIn 0.3s ease-out;
        }
        
        .notification.success {
            background-color: #28a745;
        }
        
        .notification.error {
            background-color: #dc3545;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .empty-state h3 {
            margin-bottom: 10px;
            color: #1a3a8f;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚úàÔ∏è Malaysia Airlines Stations Database</h1>
            <p class="subtitle">Complete reference for all Malaysia Airlines destinations with GMT offsets</p>
        </div>
        
        <div class="data-actions">
            <button class="btn btn-primary" id="exportBtn">Export to JSON</button>
            <button class="btn btn-secondary" id="importBtn">Import Stations</button>
            <button class="btn btn-success" id="resetBtn">Reset to Default</button>
        </div>
        
        <div class="controls">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Search by IATA code, station name, or country...">
                <span class="search-icon">üîç</span>
            </div>
            
            <div class="filter-group">
                <select id="regionFilter">
                    <option value="">All Regions</option>
                    <option value="malaysia">Malaysia (Domestic)</option>
                    <option value="seasia">Southeast Asia</option>
                    <option value="eastasia">East Asia</option>
                    <option value="southasia">South Asia</option>
                    <option value="australia">Australia/NZ</option>
                    <option value="middleeast">Middle East</option>
                    <option value="europe">Europe</option>
                    <option value="america">Americas</option>
                </select>
                
                <select id="gmtFilter">
                    <option value="">All GMT Offsets</option>
                    <option value="-8">GMT-8 to -5 (Americas)</option>
                    <option value="0">GMT 0 to +2 (Europe)</option>
                    <option value="3">GMT+3 to +5 (Middle East)</option>
                    <option value="5.5">GMT+5:30 (India)</option>
                    <option value="6">GMT+6 to +7 (SE Asia)</option>
                    <option value="8">GMT+8 (Malaysia, China)</option>
                    <option value="9">GMT+9 to +10 (East Asia/Aus)</option>
                    <option value="12">GMT+12 to +13 (NZ)</option>
                </select>
                
                <div class="station-count">
                    <span id="stationCount">0</span> stations
                </div>
            </div>
        </div>
        
        <div class="stations-table-container">
            <table id="stationsTable">
                <thead>
                    <tr>
                        <th>IATA Code</th>
                        <th>Station Name</th>
                        <th>Country</th>
                        <th>GMT Offset</th>
                        <th>DST Info</th>
                        <th>Region</th>
                    </tr>
                </thead>
                <tbody id="stationsBody">
                    <!-- Stations will be populated by JavaScript -->
                </tbody>
            </table>
        </div>
        
        <div id="emptyState" class="empty-state" style="display: none;">
            <h3>No stations found</h3>
            <p>Try changing your search or filter criteria</p>
        </div>
        
        <div class="new-station-form">
            <h3>Add New Station</h3>
            <div class="form-grid">
                <div class="form-group">
                    <label for="newIata">IATA Code</label>
                    <input type="text" id="newIata" placeholder="e.g., LHR" maxlength="3" style="text-transform: uppercase;">
                </div>
                <div class="form-group">
                    <label for="newName">Station Name</label>
                    <input type="text" id="newName" placeholder="e.g., London Heathrow">
                </div>
                <div class="form-group">
                    <label for="newCountry">Country</label>
                    <input type="text" id="newCountry" placeholder="e.g., United Kingdom">
                </div>
                <div class="form-group">
                    <label for="newGMT">GMT Offset</label>
                    <select id="newGMT">
                        <option value="-12">GMT-12:00</option>
                        <option value="-11">GMT-11:00</option>
                        <option value="-10">GMT-10:00</option>
                        <option value="-9.5">GMT-09:30</option>
                        <option value="-9">GMT-09:00</option>
                        <option value="-8">GMT-08:00</option>
                        <option value="-7">GMT-07:00</option>
                        <option value="-6">GMT-06:00</option>
                        <option value="-5">GMT-05:00</option>
                        <option value="-4">GMT-04:00</option>
                        <option value="-3.5">GMT-03:30</option>
                        <option value="-3">GMT-03:00</option>
                        <option value="-2">GMT-02:00</option>
                        <option value="-1">GMT-01:00</option>
                        <option value="0">GMT+00:00</option>
                        <option value="1">GMT+01:00</option>
                        <option value="2">GMT+02:00</option>
                        <option value="3">GMT+03:00</option>
                        <option value="3.5">GMT+03:30</option>
                        <option value="4">GMT+04:00</option>
                        <option value="4.5">GMT+04:30</option>
                        <option value="5">GMT+05:00</option>
                        <option value="5.5">GMT+05:30</option>
                        <option value="5.75">GMT+05:45</option>
                        <option value="6">GMT+06:00</option>
                        <option value="6.5">GMT+06:30</option>
                        <option value="7" selected>GMT+07:00</option>
                        <option value="8">GMT+08:00</option>
                        <option value="9">GMT+09:00</option>
                        <option value="9.5">GMT+09:30</option>
                        <option value="10">GMT+10:00</option>
                        <option value="10.5">GMT+10:30</option>
                        <option value="11">GMT+11:00</option>
                        <option value="12">GMT+12:00</option>
                        <option value="12.75">GMT+12:45</option>
                        <option value="13">GMT+13:00</option>
                        <option value="14">GMT+14:00</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="newDST">DST Information</label>
                    <select id="newDST">
                        <option value="">No DST</option>
                        <option value="+1 Mar-Oct">DST: GMT+1 Mar-Oct (Europe)</option>
                        <option value="+1 Oct-Apr">DST: GMT+1 Oct-Apr (Aus)</option>
                        <option value="+1 Sep-Apr">DST: GMT+1 Sep-Apr (NZ)</option>
                        <option value="-1 Mar-Nov">DST: GMT-1 Mar-Nov (US)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="newRegion">Region</label>
                    <select id="newRegion">
                        <option value="malaysia">Malaysia (Domestic)</option>
                        <option value="seasia">Southeast Asia</option>
                        <option value="eastasia">East Asia</option>
                        <option value="southasia">South Asia</option>
                        <option value="australia">Australia/NZ</option>
                        <option value="middleeast">Middle East</option>
                        <option value="europe">Europe</option>
                        <option value="america">Americas</option>
                    </select>
                </div>
            </div>
            <div class="form-actions">
                <button class="btn btn-secondary" id="clearFormBtn">Clear</button>
                <button class="btn btn-primary" id="addStationBtn">Add Station</button>
            </div>
        </div>
        
        <div class="legend">
            <h3>Legend & Key Information</h3>
            <div class="legend-items">
                <div class="legend-item">
                    <div class="legend-color base"></div>
                    <span>Base Station (KUL - Kuala Lumpur)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color dst"></div>
                    <span>Stations with Daylight Saving Time</span>
                </div>
                <div class="legend-item">
                    <div class="gmt-offset">GMT+8</div>
                    <span>Standard GMT offset (no DST)</span>
                </div>
                <div class="legend-item">
                    <div class="gmt-offset negative">GMT-5</div>
                    <span>Negative GMT offset (Americas)</span>
                </div>
                <div class="legend-item">
                    <div class="gmt-offset half">GMT+5:30</div>
                    <span>Half-hour GMT offset</span>
                </div>
            </div>
            <p style="margin-top: 15px; font-size: 0.9rem; color: #666;">
                <strong>Note:</strong> DST (Daylight Saving Time) periods are approximate and may vary by year. 
                Always verify current GMT offsets during season changes.
            </p>
        </div>
        
        <div class="footer">
            <p>Malaysia Airlines Stations Database ‚Ä¢ For FTL Calculator by *2100551* ‚Ä¢ Data current as of December 2025</p>
            <p style="margin-top: 5px;">
                <a href="index.html" style="color: #1a3a8f; text-decoration: none; font-weight: 500;">‚Üê Back to FTL Calculator</a>
            </p>
        </div>
    </div>

    <script>
        // Comprehensive Malaysia Airlines Stations Database
        const DEFAULT_STATIONS = [
            // Malaysia Domestic (GMT+8)
            {iata: "KUL", name: "Kuala Lumpur International", country: "Malaysia", gmt: 8, dst: "", region: "malaysia", isBase: true},
            {iata: "PEN", name: "Penang International", country: "Malaysia", gmt: 8, dst: "", region: "malaysia"},
            {iata: "KCH", name: "Kuching International", country: "Malaysia", gmt: 8, dst: "", region: "malaysia"},
            {iata: "BKI", name: "Kota Kinabalu International", country: "Malaysia", gmt: 8, dst: "", region: "malaysia"},
            {iata: "MYY", name: "Miri Airport", country: "Malaysia", gmt: 8, dst: "", region: "malaysia"},
            {iata: "TWU", name: "Tawau Airport", country: "Malaysia", gmt: 8, dst: "", region: "malaysia"},
            {iata: "LGK", name: "Langkawi International", country: "Malaysia", gmt: 8, dst: "", region: "malaysia"},
            {iata: "SBW", name: "Sibu Airport", country: "Malaysia", gmt: 8, dst: "", region: "malaysia"},
            {iata: "KUA", name: "Kuantan Sultan Ahmad Shah", country: "Malaysia", gmt: 8, dst: "", region: "malaysia"},
            {iata: "AOR", name: "Sultan Abdul Halim Airport", country: "Malaysia", gmt: 8, dst: "", region: "malaysia"},
            {iata: "KBR", name: "Sultan Ismail Petra Airport", country: "Malaysia", gmt: 8, dst: "", region: "malaysia"},
            {iata: "LBU", name: "Labuan Airport", country: "Malaysia", gmt: 8, dst: "", region: "malaysia"},
            {iata: "BTU", name: "Bintulu Airport", country: "Malaysia", gmt: 8, dst: "", region: "malaysia"},
            {iata: "SDK", name: "Sandakan Airport", country: "Malaysia", gmt: 8, dst: "", region: "malaysia"},
            {iata: "TGG", name: "Sultan Mahmud Airport", country: "Malaysia", gmt: 8, dst: "", region: "malaysia"},
            
            // Southeast Asia
            {iata: "SIN", name: "Singapore Changi", country: "Singapore", gmt: 8, dst: "", region: "seasia"},
            {iata: "BKK", name: "Suvarnabhumi Airport", country: "Thailand", gmt: 7, dst: "", region: "seasia"},
            {iata: "RGN", name: "Yangon International", country: "Myanmar", gmt: 6.5, dst: "", region: "seasia"},
            {iata: "KNO", name: "Kualanamu International", country: "Indonesia", gmt: 7, dst: "", region: "seasia"},
            {iata: "CGK", name: "Soekarno-Hatta International", country: "Indonesia", gmt: 7, dst: "", region: "seasia"},
            {iata: "DPS", name: "Ngurah Rai International", country: "Indonesia", gmt: 8, dst: "", region: "seasia"},
            {iata: "SGN", name: "Tan Son Nhat International", country: "Vietnam", gmt: 7, dst: "", region: "seasia"},
            {iata: "HAN", name: "Noi Bai International", country: "Vietnam", gmt: 7, dst: "", region: "seasia"},
            {iata: "PNH", name: "Phnom Penh International", country: "Cambodia", gmt: 7, dst: "", region: "seasia"},
            {iata: "REP", name: "Siem Reap International", country: "Cambodia", gmt: 7, dst: "", region: "seasia"},
            {iata: "KTI", name: "Kratie Airport", country: "Cambodia", gmt: 7, dst: "", region: "seasia"},
            {iata: "VTE", name: "Wattay International", country: "Laos", gmt: 7, dst: "", region: "seasia"},
            {iata: "MNL", name: "Ninoy Aquino International", country: "Philippines", gmt: 8, dst: "", region: "seasia"},
            {iata: "CEB", name: "Mactan-Cebu International", country: "Philippines", gmt: 8, dst: "", region: "seasia"},
            {iata: "DVO", name: "Francisco Bangoy International", country: "Philippines", gmt: 8, dst: "", region: "seasia"},
            {iata: "BWN", name: "Brunei International", country: "Brunei", gmt: 8, dst: "", region: "seasia"},
            
            // Australia & New Zealand
            {iata: "PER", name: "Perth Airport", country: "Australia", gmt: 8, dst: "", region: "australia"},
            {iata: "ADL", name: "Adelaide Airport", country: "Australia", gmt: 9.5, dst: "+1 Oct-Apr", region: "australia"},
            {iata: "MEL", name: "Melbourne Airport", country: "Australia", gmt: 10, dst: "+1 Oct-Apr", region: "australia"},
            {iata: "SYD", name: "Sydney Kingsford Smith", country: "Australia", gmt: 10, dst: "+1 Oct-Apr", region: "australia"},
            {iata: "BNE", name: "Brisbane Airport", country: "Australia", gmt: 10, dst: "", region: "australia"},
            {iata: "AKL", name: "Auckland Airport", country: "New Zealand", gmt: 12, dst: "+1 Sep-Apr", region: "australia"},
            {iata: "CHC", name: "Christchurch Airport", country: "New Zealand", gmt: 12, dst: "+1 Sep-Apr", region: "australia"},
            {iata: "WLG", name: "Wellington Airport", country: "New Zealand", gmt: 12, dst: "+1 Sep-Apr", region: "australia"},
            
            // East Asia
            {iata: "NRT", name: "Narita International", country: "Japan", gmt: 9, dst: "", region: "eastasia"},
            {iata: "HND", name: "Haneda Airport", country: "Japan", gmt: 9, dst: "", region: "eastasia"},
            {iata: "KIX", name: "Kansai International", country: "Japan", gmt: 9, dst: "", region: "eastasia"},
            {iata: "ICN", name: "Incheon International", country: "South Korea", gmt: 9, dst: "", region: "eastasia"},
            {iata: "PVG", name: "Shanghai Pudong International", country: "China", gmt: 8, dst: "", region: "eastasia"},
            {iata: "PEK", name: "Beijing Capital International", country: "China", gmt: 8, dst: "", region: "eastasia"},
            {iata: "CAN", name: "Guangzhou Baiyun International", country: "China", gmt: 8, dst: "", region: "eastasia"},
            {iata: "HKG", name: "Hong Kong International", country: "China (SAR)", gmt: 8, dst: "", region: "eastasia"},
            {iata: "TPE", name: "Taiwan Taoyuan International", country: "Taiwan", gmt: 8, dst: "", region: "eastasia"},
            {iata: "MFM", name: "Macau International", country: "China (SAR)", gmt: 8, dst: "", region: "eastasia"},
            
            // South Asia
            {iata: "DEL", name: "Indira Gandhi International", country: "India", gmt: 5.5, dst: "", region: "southasia"},
            {iata: "BOM", name: "Chhatrapati Shivaji Maharaj", country: "India", gmt: 5.5, dst: "", region: "southasia"},
            {iata: "MAA", name: "Chennai International", country: "India", gmt: 5.5, dst: "", region: "southasia"},
            {iata: "CCU", name: "Netaji Subhash Chandra Bose", country: "India", gmt: 5.5, dst: "", region: "southasia"},
            {iata: "CMB", name: "Bandaranaike International", country: "Sri Lanka", gmt: 5.5, dst: "", region: "southasia"},
            {iata: "KTM", name: "Tribhuvan International", country: "Nepal", gmt: 5.75, dst: "", region: "southasia"},
            
            // Middle East
            {iata: "DOH", name: "Hamad International", country: "Qatar", gmt: 3, dst: "", region: "middleeast"},
            {iata: "DXB", name: "Dubai International", country: "UAE", gmt: 4, dst: "", region: "middleeast"},
            {iata: "AUH", name: "Abu Dhabi International", country: "UAE", gmt: 4, dst: "", region: "middleeast"},
            {iata: "JED", name: "King Abdulaziz International", country: "Saudi Arabia", gmt: 3, dst: "", region: "middleeast"},
            {iata: "RUH", name: "King Khalid International", country: "Saudi Arabia", gmt: 3, dst: "", region: "middleeast"},
            
            // Europe
            {iata: "LHR", name: "London Heathrow", country: "United Kingdom", gmt: 0, dst: "+1 Mar-Oct", region: "europe"},
            {iata: "AMS", name: "Amsterdam Schiphol", country: "Netherlands", gmt: 1, dst: "+1 Mar-Oct", region: "europe"},
            {iata: "CDG", name: "Paris Charles de Gaulle", country: "France", gmt: 1, dst: "+1 Mar-Oct", region: "europe"},
            {iata: "FRA", name: "Frankfurt Airport", country: "Germany", gmt: 1, dst: "+1 Mar-Oct", region: "europe"},
            {iata: "IST", name: "Istanbul Airport", country: "Turkey", gmt: 3, dst: "", region: "europe"},
            
            // Americas
            {iata: "LAX", name: "Los Angeles International", country: "USA", gmt: -8, dst: "-1 Mar-Nov", region: "america"},
            {iata: "JFK", name: "John F. Kennedy International", country: "USA", gmt: -5, dst: "-1 Mar-Nov", region: "america"}
        ];

        class StationsDatabase {
            constructor() {
                this.stations = this.loadStations();
                this.init();
            }
            
            loadStations() {
                const saved = localStorage.getItem('mh_stations_db');
                if (saved) {
                    try {
                        return JSON.parse(saved);
                    } catch (e) {
                        console.error('Error loading saved stations:', e);
                        return DEFAULT_STATIONS;
                    }
                }
                return DEFAULT_STATIONS;
            }
            
            saveStations() {
                localStorage.setItem('mh_stations_db', JSON.stringify(this.stations));
            }
            
            init() {
                this.renderTable();
                this.bindEvents();
                this.updateStationCount();
            }
            
            renderTable(filteredStations = null) {
                const stations = filteredStations || this.stations;
                const tbody = document.getElementById('stationsBody');
                const emptyState = document.getElementById('emptyState');
                
                if (stations.length === 0) {
                    tbody.innerHTML = '';
                    emptyState.style.display = 'block';
                    return;
                }
                
                emptyState.style.display = 'none';
                
                tbody.innerHTML = stations.map(station => {
                    const gmtClass = station.gmt < 0 ? 'negative' : 
                                   (station.gmt % 1 !== 0 ? 'half' : '');
                    
                    const gmtDisplay = station.gmt > 0 ? `GMT+${station.gmt}` : `GMT${station.gmt}`;
                    
                    return `
                        <tr class="${station.isBase ? 'base-station' : ''}">
                            <td>
                                <div class="iata-code">${station.iata}</div>
                                ${station.isBase ? '<span class="base-badge">BASE</span>' : ''}
                            </td>
                            <td>
                                <div class="station-name">${station.name}</div>
                            </td>
                            <td>
                                <div class="country">${station.country}</div>
                            </td>
                            <td>
                                <div class="gmt-offset ${gmtClass}">${gmtDisplay}</div>
                                ${station.dst ? `<div class="dst-indicator has-dst">${station.dst}</div>` : ''}
                            </td>
                            <td>
                                ${station.dst || 'No DST'}
                            </td>
                            <td>
                                ${this.getRegionDisplay(station.region)}
                            </td>
                        </tr>
                    `;
                }).join('');
            }
            
            getRegionDisplay(region) {
                const regions = {
                    malaysia: 'Malaysia',
                    seasia: 'SE Asia',
                    eastasia: 'East Asia',
                    southasia: 'South Asia',
                    australia: 'Australia/NZ',
                    middleeast: 'Middle East',
                    europe: 'Europe',
                    america: 'Americas'
                };
                return regions[region] || region;
            }
            
            filterStations() {
                const searchTerm = document.getElementById('searchInput').value.toLowerCase();
                const region = document.getElementById('regionFilter').value;
                const gmtFilter = document.getElementById('gmtFilter').value;
                
                let filtered = this.stations;
                
                // Apply search filter
                if (searchTerm) {
                    filtered = filtered.filter(station => 
                        station.iata.toLowerCase().includes(searchTerm) ||
                        station.name.toLowerCase().includes(searchTerm) ||
                        station.country.toLowerCase().includes(searchTerm)
                    );
                }
                
                // Apply region filter
                if (region) {
                    filtered = filtered.filter(station => station.region === region);
                }
                
                // Apply GMT filter
                if (gmtFilter) {
                    const gmtValue = parseFloat(gmtFilter);
                    filtered = filtered.filter(station => {
                        const stationGMT = station.gmt;
                        if (gmtValue === 5.5) return stationGMT === 5.5 || stationGMT === 5.75;
                        if (gmtValue === -8) return stationGMT >= -8 && stationGMT <= -5;
                        if (gmtValue === 0) return stationGMT >= 0 && stationGMT <= 2;
                        if (gmtValue === 3) return stationGMT >= 3 && stationGMT <= 5;
                        if (gmtValue === 6) return stationGMT >= 6 && stationGMT <= 7;
                        if (gmtValue === 8) return stationGMT === 8;
                        if (gmtValue === 9) return stationGMT >= 9 && stationGMT <= 10;
                        if (gmtValue === 12) return stationGMT >= 12 && stationGMT <= 13;
                        return true;
                    });
                }
                
                this.renderTable(filtered);
                this.updateStationCount(filtered.length);
            }
            
            updateStationCount(count = null) {
                const total = count !== null ? count : this.stations.length;
                document.getElementById('stationCount').textContent = total;
            }
            
            addStation(station) {
                // Check if station already exists
                const exists = this.stations.find(s => s.iata === station.iata);
                if (exists) {
                    this.showNotification('Station already exists!', 'error');
                    return false;
                }
                
                this.stations.push(station);
                this.saveStations();
                this.renderTable();
                this.updateStationCount();
                this.showNotification('Station added successfully!', 'success');
                return true;
            }
            
            resetToDefault() {
                if (confirm('Reset all stations to default? This will remove any custom stations you added.')) {
                    this.stations = DEFAULT_STATIONS;
                    this.saveStations();
                    this.renderTable();
                    this.updateStationCount();
                    this.showNotification('Database reset to default!', 'success');
                }
            }
            
            exportToJSON() {
                const dataStr = JSON.stringify(this.stations, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                
                const link = document.createElement('a');
                link.href = url;
                link.download = 'malaysia-airlines-stations.json';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
                this.showNotification('Stations exported successfully!', 'success');
            }
            
            importStations() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                
                input.onchange = e => {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    
                    reader.onload = event => {
                        try {
                            const imported = JSON.parse(event.target.result);
                            if (Array.isArray(imported) && imported.every(s => s.iata && s.name)) {
                                this.stations = imported;
                                this.saveStations();
                                this.renderTable();
                                this.updateStationCount();
                                this.showNotification('Stations imported successfully!', 'success');
                            } else {
                                this.showNotification('Invalid stations file format!', 'error');
                            }
                        } catch (err) {
                            this.showNotification('Error parsing JSON file!', 'error');
                        }
                    };
                    
                    reader.readAsText(file);
                };
                
                input.click();
            }
            
            showNotification(message, type) {
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                notification.textContent = message;
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.style.opacity = '0';
                    setTimeout(() => {
                        document.body.removeChild(notification);
                    }, 300);
                }, 3000);
            }
            
            bindEvents() {
                // Search input
                document.getElementById('searchInput').addEventListener('input', () => {
                    this.filterStations();
                });
                
                // Filter changes
                document.getElementById('regionFilter').addEventListener('change', () => {
                    this.filterStations();
                });
                
                document.getElementById('gmtFilter').addEventListener('change', () => {
                    this.filterStations();
                });
                
                // Add station button
                document.getElementById('addStationBtn').addEventListener('click', () => {
                    this.handleAddStation();
                });
                
                // Clear form button
                document.getElementById('clearFormBtn').addEventListener('click', () => {
                    this.clearForm();
                });
                
                // Enter key in IATA field
                document.getElementById('newIata').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.handleAddStation();
                    }
                });
                
                // Export button
                document.getElementById('exportBtn').addEventListener('click', () => {
                    this.exportToJSON();
                });
                
                // Import button
                document.getElementById('importBtn').addEventListener('click', () => {
                    this.importStations();
                });
                
                // Reset button
                document.getElementById('resetBtn').addEventListener('click', () => {
                    this.resetToDefault();
                });
            }
            
            handleAddStation() {
                const iata = document.getElementById('newIata').value.toUpperCase().trim();
                const name = document.getElementById('newName').value.trim();
                const country = document.getElementById('newCountry').value.trim();
                const gmt = parseFloat(document.getElementById('newGMT').value);
                const dst = document.getElementById('newDST').value;
                const region = document.getElementById('newRegion').value;
                
                // Validation
                if (!iata || iata.length !== 3) {
                    this.showNotification('IATA code must be 3 letters!', 'error');
                    return;
                }
                
                if (!name) {
                    this.showNotification('Station name is required!', 'error');
                    return;
                }
                
                if (!country) {
                    this.showNotification('Country is required!', 'error');
                    return;
                }
                
                const newStation = {
                    iata,
                    name,
                    country,
                    gmt,
                    dst,
                    region,
                    isBase: iata === 'KUL'
                };
                
                if (this.addStation(newStation)) {
                    this.clearForm();
                }
            }
            
            clearForm() {
                document.getElementById('newIata').value = '';
                document.getElementById('newName').value = '';
                document.getElementById('newCountry').value = '';
                document.getElementById('newGMT').value = '7';
                document.getElementById('newDST').value = '';
                document.getElementById('newRegion').value = 'seasia';
                document.getElementById('newIata').focus();
            }
            
            getStation(iata) {
                return this.stations.find(s => s.iata === iata.toUpperCase());
            }
            
            getStationGMT(iata, date = null) {
                const station = this.getStation(iata);
                if (!station) return null;
                
                // Simple DST handling - in a real app, this would need to be more sophisticated
                if (station.dst && date) {
                    // Parse DST pattern like "+1 Mar-Oct"
                    const match = station.dst.match(/^([+-]\d+)\s+(\w+)-(\w+)$/);
                    if (match) {
                        const offset = parseInt(match[1]);
                        const startMonth = this.getMonthNumber(match[2]);
                        const endMonth = this.getMonthNumber(match[3]);
                        const currentMonth = date.getMonth() + 1; // JS months are 0-indexed
                        
                        // Check if current month is in DST period
                        if (startMonth <= endMonth) {
                            if (currentMonth >= startMonth && currentMonth <= endMonth) {
                                return station.gmt + offset;
                            }
                        } else {
                            // DST period wraps around year end (e.g., Oct-Apr)
                            if (currentMonth >= startMonth || currentMonth <= endMonth) {
                                return station.gmt + offset;
                            }
                        }
                    }
                }
                
                return station.gmt;
            }
            
            getMonthNumber(monthAbbr) {
                const months = {
                    'Jan': 1, 'Feb': 2, 'Mar': 3, 'Apr': 4, 'May': 5, 'Jun': 6,
                    'Jul': 7, 'Aug': 8, 'Sep': 9, 'Oct': 10, 'Nov': 11, 'Dec': 12
                };
                return months[monthAbbr] || 1;
            }
        }

        // Initialize the database when page loads
        document.addEventListener('DOMContentLoaded', () => {
            window.stationsDB = new StationsDatabase();
        });
    </script>
</body>
</html>